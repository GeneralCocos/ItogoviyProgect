[2025-11-23T13:49:56.639+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-11-23T13:49:56.712+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: cbr_daily_to_raw.load_daily_rates scheduled__2025-11-22T00:00:00+00:00 [queued]>
[2025-11-23T13:49:56.727+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: cbr_daily_to_raw.load_daily_rates scheduled__2025-11-22T00:00:00+00:00 [queued]>
[2025-11-23T13:49:56.728+0000] {taskinstance.py:2306} INFO - Starting attempt 2 of 2
[2025-11-23T13:49:56.759+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load_daily_rates> on 2025-11-22 00:00:00+00:00
[2025-11-23T13:49:56.774+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'cbr_daily_to_raw', 'load_daily_rates', 'scheduled__2025-11-22T00:00:00+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/cbr_daily_to_raw.py', '--cfg-path', '/tmp/tmpxjzsfzvz']
[2025-11-23T13:49:56.782+0000] {standard_task_runner.py:91} INFO - Job 5: Subtask load_daily_rates
[2025-11-23T13:49:56.783+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=198) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-11-23T13:49:56.785+0000] {standard_task_runner.py:63} INFO - Started process 199 to run task
[2025-11-23T13:49:56.915+0000] {task_command.py:426} INFO - Running <TaskInstance: cbr_daily_to_raw.load_daily_rates scheduled__2025-11-22T00:00:00+00:00 [running]> on host cc24749093be
[2025-11-23T13:49:57.124+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='cbr_daily_to_raw' AIRFLOW_CTX_TASK_ID='load_daily_rates' AIRFLOW_CTX_EXECUTION_DATE='2025-11-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-11-22T00:00:00+00:00'
[2025-11-23T13:49:57.125+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-11-23T13:49:57.465+0000] {base.py:84} INFO - Using connection ID 'raw_postgres' for task execution.
[2025-11-23T13:49:57.476+0000] {sql.py:487} INFO - Running statement: 
            INSERT INTO cbr.cbr_daily_rates_raw (
                rate_date,
                num_code,
                char_code,
                nominal,
                name,
                value
            )
            VALUES (%s, %s, %s, %s, %s, %s)
            ON CONFLICT (rate_date, char_code) DO UPDATE
            SET num_code  = EXCLUDED.num_code,
                nominal   = EXCLUDED.nominal,
                name      = EXCLUDED.name,
                value     = EXCLUDED.value,
                load_dttm = now();
        , parameters: [(datetime.date(2025, 11, 22), '036', 'AUD', 1, 'Австралийский доллар', 50.9393), (datetime.date(2025, 11, 22), '944', 'AZN', 1, 'Азербайджанский манат', 46.4851), (datetime.date(2025, 11, 22), '012', 'DZD', 100, 'Алжирских динаров', 60.5631), (datetime.date(2025, 11, 22), '826', 'GBP', 1, 'Фунт стерлингов', 103.4906), (datetime.date(2025, 11, 22), '051', 'AMD', 100, 'Армянских драмов', 20.7082), (datetime.date(2025, 11, 22), '048', 'BHD', 1, 'Бахрейнский динар', 210.1264), (datetime.date(2025, 11, 22), '933', 'BYN', 1, 'Белорусский рубль', 27.0502), (datetime.date(2025, 11, 22), '975', 'BGN', 1, 'Болгарский лев', 46.522), (datetime.date(2025, 11, 22), '068', 'BOB', 1, 'Боливиано', 11.4363), (datetime.date(2025, 11, 22), '986', 'BRL', 1, 'Бразильский реал', 14.8144), (datetime.date(2025, 11, 22), '348', 'HUF', 100, 'Форинтов', 23.7012), (datetime.date(2025, 11, 22), '704', 'VND', 10000, 'Донгов', 31.4388), (datetime.date(2025, 11, 22), '344', 'HKD', 1, 'Гонконгский доллар', 10.1679), (datetime.date(2025, 11, 22), '981', 'GEL', 1, 'Лари', 29.1959), (datetime.date(2025, 11, 22), '208', 'DKK', 1, 'Датская крона', 12.182), (datetime.date(2025, 11, 22), '784', 'AED', 1, 'Дирхам ОАЭ', 21.5179), (datetime.date(2025, 11, 22), '840', 'USD', 1, 'Доллар США', 79.0246), (datetime.date(2025, 11, 22), '978', 'EUR', 1, 'Евро', 90.5625), (datetime.date(2025, 11, 22), '818', 'EGP', 10, 'Египетских фунтов', 16.6528), (datetime.date(2025, 11, 22), '356', 'INR', 100, 'Индийских рупий', 89.1521), (datetime.date(2025, 11, 22), '360', 'IDR', 10000, 'Рупий', 47.2014), (datetime.date(2025, 11, 22), '364', 'IRR', 100000, 'Иранских риалов', 13.1243), (datetime.date(2025, 11, 22), '398', 'KZT', 100, 'Тенге', 15.2501), (datetime.date(2025, 11, 22), '124', 'CAD', 1, 'Канадский доллар', 56.1254), (datetime.date(2025, 11, 22), '634', 'QAR', 1, 'Катарский риал', 21.7101), (datetime.date(2025, 11, 22), '417', 'KGS', 100, 'Сомов', 90.3655), (datetime.date(2025, 11, 22), '156', 'CNY', 1, 'Юань', 11.0576), (datetime.date(2025, 11, 22), '192', 'CUP', 10, 'Кубинских песо', 32.9269), (datetime.date(2025, 11, 22), '498', 'MDL', 10, 'Молдавских леев', 46.0852), (datetime.date(2025, 11, 22), '496', 'MNT', 1000, 'Тугриков', 22.174), (datetime.date(2025, 11, 22), '566', 'NGN', 1000, 'Найр', 54.4196), (datetime.date(2025, 11, 22), '554', 'NZD', 1, 'Новозеландский доллар', 44.2024), (datetime.date(2025, 11, 22), '578', 'NOK', 10, 'Норвежских крон', 77.5002), (datetime.date(2025, 11, 22), '512', 'OMR', 1, 'Оманский риал', 205.5256), (datetime.date(2025, 11, 22), '985', 'PLN', 1, 'Злотый', 21.4345), (datetime.date(2025, 11, 22), '682', 'SAR', 1, 'Саудовский риял', 21.0732), (datetime.date(2025, 11, 22), '946', 'RON', 1, 'Румынский лей', 17.8853), (datetime.date(2025, 11, 22), '960', 'XDR', 1, 'СДР (специальные права заимствования)', 107.0001), (datetime.date(2025, 11, 22), '702', 'SGD', 1, 'Сингапурский доллар', 60.4348), (datetime.date(2025, 11, 22), '972', 'TJS', 10, 'Сомони', 85.0559), (datetime.date(2025, 11, 22), '764', 'THB', 10, 'Батов', 24.3302), (datetime.date(2025, 11, 22), '050', 'BDT', 100, 'Так', 64.5134), (datetime.date(2025, 11, 22), '949', 'TRY', 10, 'Турецких лир', 18.6703), (datetime.date(2025, 11, 22), '934', 'TMT', 1, 'Новый туркменский манат', 22.5785), (datetime.date(2025, 11, 22), '860', 'UZS', 10000, 'Узбекских сумов', 66.3255), (datetime.date(2025, 11, 22), '980', 'UAH', 10, 'Гривен', 18.7462), (datetime.date(2025, 11, 22), '203', 'CZK', 10, 'Чешских крон', 37.629), (datetime.date(2025, 11, 22), '752', 'SEK', 10, 'Шведских крон', 82.721), (datetime.date(2025, 11, 22), '756', 'CHF', 1, 'Швейцарский франк', 98.1306), (datetime.date(2025, 11, 22), '230', 'ETB', 100, 'Эфиопских быров', 51.2847), (datetime.date(2025, 11, 22), '941', 'RSD', 100, 'Сербских динаров', 77.748), (datetime.date(2025, 11, 22), '710', 'ZAR', 10, 'Рэндов', 45.7152), (datetime.date(2025, 11, 22), '410', 'KRW', 1000, 'Вон', 53.8168), (datetime.date(2025, 11, 22), '392', 'JPY', 100, 'Иен', 50.2062), (datetime.date(2025, 11, 22), '104', 'MMK', 1000, 'Кьятов', 37.6308)]
[2025-11-23T13:49:57.479+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-11-23T13:49:57.480+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py", line 265, in execute
    return_value = super().execute(context)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/cbr_daily_to_raw.py", line 128, in load_daily_rates
    hook.run(insert_sql, parameters=rows)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/hooks/sql.py", line 435, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/hooks/sql.py", line 490, in _run_command
    cur.execute(sql_statement, parameters)
TypeError: not all arguments converted during string formatting
[2025-11-23T13:49:57.497+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=cbr_daily_to_raw, task_id=load_daily_rates, run_id=scheduled__2025-11-22T00:00:00+00:00, execution_date=20251122T000000, start_date=20251123T134956, end_date=20251123T134957
[2025-11-23T13:49:57.510+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 5 for task load_daily_rates (not all arguments converted during string formatting; 199)
[2025-11-23T13:49:57.523+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-11-23T13:49:57.544+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-11-23T13:49:57.547+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
